<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- <link rel="icon" href="/favicon.ico" /> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Svelte + Vite App</title>
    <script type="module" crossorigin src="/vite_svelte/assets/index.41a86f78.js"></script>
    <link rel="modulepreload" href="/vite_svelte/assets/vendor.a480a1e0.js" />
    <link rel="stylesheet" href="/vite_svelte/assets/index.44973758.css" />
    <script src="/util/jquery.min.js"></script>

    <script>
      partytown = {
        resolveUrl(url, location) {
          if (url.hostname.includes('www.google-analytics.com')) {
            const proxyUrl = new URL('https://cdn.builder.io/api/v1/proxy-api');
            proxyUrl.searchParams.append('url', url.href);
            return proxyUrl;
          }
          return url;
        },
        forward: ['dataLayer.push'], // “ttq.track”, “ttq.page”, “ttq.load”
        debug: true,
        logCalls: true,
        logGetters: true,
        logSetters: true,
        logImageRequests: true,
        logMainAccess: true,
        logSendBeaconRequests: true,
        logStackTraces: false,
        logScriptExecution: true
      };
    </script>

    <script>
      /* Partytown 0.3.6 - MIT builder.io */
      !(function (win, doc, nav, top, useAtomics, config, libPath, timeout, scripts, sandbox, mainForwardFn, isReady) {
        function ready() {
          if (!isReady) {
            isReady = 1;
            libPath = (config.lib || '/~partytown/') + (false !== config.debug ? 'debug/' : '');
            if ('/' == libPath[0]) {
              scripts = doc.querySelectorAll('script[type="text/partytown"]');
              if (top != win) {
                top.dispatchEvent(
                  new CustomEvent('pt1', {
                    detail: win
                  })
                );
              } else if (scripts.length) {
                timeout = setTimeout(fallback, 1e4);
                doc.addEventListener('pt0', clearFallback);
                useAtomics
                  ? loadSandbox(1)
                  : nav.serviceWorker
                  ? nav.serviceWorker
                      .register(libPath + 'partytown-sw.js', {
                        scope: libPath
                      })
                      .then(function (swRegistration) {
                        if (swRegistration.active) {
                          loadSandbox();
                        } else if (swRegistration.installing) {
                          swRegistration.installing.addEventListener('statechange', function (ev) {
                            'activated' == ev.target.state && loadSandbox();
                          });
                        } else {
                          console.warn(swRegistration);
                        }
                      }, console.error)
                  : fallback();
              } else {
                0 === scripts.length && console.debug('No Partytown scripts found');
              }
            } else {
              console.warn('Partytown config.lib url must start with "/"');
            }
          }
        }
        function loadSandbox(isAtomics) {
          sandbox = doc.createElement(isAtomics ? 'script' : 'iframe');
          if (!isAtomics) {
            sandbox.setAttribute('style', 'display:block;width:0;height:0;border:0;visibility:hidden');
            sandbox.setAttribute('aria-hidden', !0);
          }
          sandbox.src = libPath + 'partytown-' + (isAtomics ? 'atomics.js' : 'sandbox-sw.html?' + Date.now());
          doc.body.appendChild(sandbox);
        }
        function fallback(i, script) {
          console.warn('Partytown script fallback');
          clearFallback();
          for (i = 0; i < scripts.length; i++) {
            script = doc.createElement('script');
            script.innerHTML = scripts[i].innerHTML;
            doc.head.appendChild(script);
          }
          sandbox && sandbox.parentNode.removeChild(sandbox);
        }
        function clearFallback() {
          clearTimeout(timeout);
        }
        config = win.partytown || {};
        top == win &&
          (config.forward || []).map(function (forwardProps) {
            mainForwardFn = win;
            forwardProps.split('.').map(function (_, i, forwardPropsArr) {
              mainForwardFn = mainForwardFn[forwardPropsArr[i]] =
                i + 1 < forwardPropsArr.length
                  ? 'push' == forwardPropsArr[i + 1]
                    ? []
                    : mainForwardFn[forwardPropsArr[i]] || {}
                  : function () {
                      (win._ptf = win._ptf || []).push(forwardPropsArr, arguments);
                    };
            });
          });
        if ('complete' == doc.readyState) {
          ready();
        } else {
          win.addEventListener('DOMContentLoaded', ready);
          win.addEventListener('load', ready);
        }
      })(window, document, navigator, top, top.crossOriginIsolated);
    </script>

    <script async="" type="text/partytown" src="https://www.googletagmanager.com/gtag/js?id=UA-222737338-1"></script>
    <script type="text/partytown">
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', 'UA-222737338-1');
      gtag('event', 'view_item', { currency: 'USD' });
    </script>
  </head>
  <body>
    <div id="app"></div>
    <script>
      function gtag() {
        dataLayer.push(arguments);
      }
      function addToCart() {
        $(document.body).trigger('partytown.addToCart', {
          content_id: '301',
          content_type: 'product',
          content_name: 'dress',
          quantity: 1,
          price: 8,
          value: 9.2,
          currency: 'USD'
        });
      }

      $(document.body).on('partytown.addToCart', function (e, v) {
        console.log('partytown.addToCart', v);
        gtag('event', 'add_to_cart', v);
      });
    </script>

    <button onclick="addToCart()" id="addToCart">gtag-addToCart</button>
  </body>
</html>
